---
title: "2024 Results"
format:
  html:
    toc: true
    toc-location: left
    toc-depth: 2
---

```{r set up}
#| include: FALSE
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(glue)
library(gt)
library(here)
library(grkmisc)
library(tidyverse)
library(ggiraph)
library(ggbeeswarm)
library(scales)
library(writexl)
library(htmltools)
source(here("R/viz/table.R"))
source(here("R/viz/download-button.R"))
source(here("R/viz/viz-results.R"))
source(here("R/misc/date.R"))


# update_geom_defaults(
#   geom = "text",
#   aes(
#     family = "Inter Tight"
#   )
# )

df <- readRDS(here("data", "responses_2024.rds")) |>
  filter(business != "TEST") |>
  replace_na(list(ezone = "No")) |>
  mutate(
    ezone = recode(
      ezone,
      "Yes" = "E-Zone Business",
      "No" = "Not E-Zone Business"
    )
  ) |>
  mutate(
    woman_owned = recode(
      woman_owned,
      "Yes" = "Woman Owned",
      "No" = "Not Woman Owned"
    )
  ) |>
  mutate(
    bipoc_owned = recode(
      bipoc_owned,
      "Yes" = "BIPOC Owned",
      "No" = "Not BIPOC Owned"
    )
  ) |>
  mutate(
    large_company = ifelse(
      n_employees > 50,
      "Large (n > 50)",
      "Small (n <= 50)"
    )
  ) |>
  mutate(
    track_dollars_spent = ifelse(
      track_dollars_spent == "",
      "Unknown",
      track_dollars_spent
    )
  ) |>
  mutate(
    pmplikert = ifelse(
      pmplikert == "",
      "Unknown",
      pmplikert
    )
  ) |>
  mutate(across(where(is.character), ~ na_if(.x, "N/A"))) |>
  replace_na(list(large_company = "Unknown"))

# condition to run chunks
df_conditions <- df |>
  select(
    dollars_spent_purchases,
    percentage_purchase,
    spend_locally_portland_ezone,
    ezone,
    bipoc_owned,
    woman_owned,
    large_company
  ) |>
  pivot_longer(-c(ezone, bipoc_owned, woman_owned, large_company)) |>
  filter(!is.na(value))

df_raw <- readRDS(here("data", "responses_2024.rds")) |>
  filter(business != "TEST")

df_completion_rates <- readRDS(here("data", "completion_rates_2024.rds")) |>
  filter(business != "TEST") |>
  select(business, has_started, has_finished)

# We want to keep only the data for businesses that finished the survey
df <- df |>
  left_join(df_completion_rates, by="business") |>
  filter(has_finished == "Yes")
```

---

# Welcome

## Did your business make progress in 2024 on any of the other Portland Means Progress actions that you didn’t originally commit to? 


```{r}
col_names <- c(
  "progress_culture",
  "progress_none",
  "progress_purchasing",
  "progress_work"
)
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
summary_table(col_names, data = df)
```

### E-Zone

```{r}
summary_table(col_names, data = df, group_cols = "ezone")
```

### Woman-Owned

```{r}
summary_table(col_names, data = df, group_cols = "woman_owned")
```

### BIPOC-Owned

```{r}
summary_table(col_names, data = df, group_cols = "bipoc_owned")
```

### Business Size

```{r}
summary_table(col_names, data = df, group_cols = "large_company")
```

:::


---

# Work Experience 

## How many interns did your business host in the Portland Metro area?

```{r, results='asis'}
intern_columns <- c("interns_eli", "interns_noneli", "interns_wsi")

all_interns <- df |>
  select(all_of(intern_columns)) |>
  summarise(across(everything(), sum, na.rm = TRUE)) |>
  mutate(total_interns = rowSums(across(everything()))) |>
  select(total_interns) |>
  pull()

text <- glue(
  "The total number of interns across all business is **{all_interns}**."
)
cat(text)
```

```{r}
interns_df <- df |>
  select(
    interns_eli,
    interns_noneli,
    interns_wsi,
    ezone,
    woman_owned,
    bipoc_owned,
    large_company
  ) |>
  pivot_longer(
    cols = starts_with("interns_"),
    names_to = "Category",
    values_to = "Value"
  ) |>
  mutate(tooltip <- paste0(
    round(Value),
    ifelse(Value > 1, " interns", " intern")
  ))
```

::: {.panel-tabset .nav-pills}

### All Businesses


```{r}
beeswarm_pmp(interns_df)
```

### E-Zone

```{r}
beeswarm_pmp(interns_df, facet_col = "ezone")
```

### Woman-Owned

```{r}
beeswarm_pmp(interns_df, facet_col = "woman_owned")
```


### BIPOC-Owned

```{r}
beeswarm_pmp(interns_df, facet_col = "bipoc_owned")
```

### Business Size

```{r}
beeswarm_pmp(interns_df, facet_col = "large_company")
```

:::

## Did your business implement any of the following policies, practices, or actions?

```{r}
col_names <- c(
  "practices_onboarding_work",
  "practices_hiring_work",
  "practices_mentor_work",
  "practices_none_work",
  "practices_interviews_work",
  "practices_training_work",
  "practices_support_work",
  "practices_retention_work"
)

df_with_condition <- df |>
  filter(action_work == "Yes" | progress_work == "Yes")
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
summary_table(col_names, data = df_with_condition)
```

### E-Zone

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "ezone")
```

### Woman-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "woman_owned")
```

### BIPOC-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "bipoc_owned")
```

### Business Size

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "large_company")
```

:::

---

# Intentional Purchasing

## Did your business implement any of the following policies, practices, or actions?

```{r}
col_names <- c(
  "practices_cobid_purchasing",
  "practices_dollar_purchasing",
  "practices_mercatus_purchasing",
  "practices_none_purchasing",
  "practices_preference_purchasing",
  "practices_relations_purchasing",
  "practices_targets_purchasing"
)

df_with_condition <- df |>
  filter(action_purchasing == "Yes" | progress_purchasing == "Yes")
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
summary_table(col_names, data = df_with_condition)
```

### E-Zone

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "ezone")
```

### Woman-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "woman_owned")
```

### BIPOC-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "bipoc_owned")
```

### Business Size

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "large_company")
```

:::

## Did your business track how much it spent at BIPOC-owned businesses in the Portland Metro area?

```{r}
df |>
  count(track_dollars_spent) |>
  mutate(percentage = n / sum(n) * 100) |>
  mutate(
    percentage = paste0(round(percentage, 1), "% (", n, " businesses)")
  ) |>
  select(-n) |>
  rename(
    Percentage = percentage,
    `Track Dollars Spent` = track_dollars_spent
  ) |>
  gt() |>
  pmp_table_theme()
```


## How many dollars did your business spend on external purchases or services from BIPOC-owned businesses in the Portland Metro area?

```{r, results='asis'}
dollar_column <- c("dollars_spent_purchases")

all_spent <- df_raw |>
  select(all_of(dollar_column)) |>
  summarise(across(everything(), sum, na.rm = TRUE)) |>
  mutate(across(everything(), ~ replace_na(.x, 0))) |>
  mutate(total_spent = rowSums(across(everything()))) |>
  select(total_spent) |>
  pull()

text <- glue(
  "The total amount of dollars spent is **{scales::dollar_format()(all_spent)}**."
)
cat(text)
```

```{r, results='asis'}
all_spent <- df_raw |>
  filter(ezone == "Yes") |>
  select(all_of(dollar_column)) |>
  summarise(across(everything(), sum, na.rm = TRUE)) |>
  mutate(across(everything(), ~ replace_na(.x, 0))) |>
  mutate(total_spent = rowSums(across(everything()))) |>
  select(total_spent) |>
  pull()

text <- glue(
  "The total amount of dollars spent by E-Zone alone is **{scales::dollar_format()(all_spent)}**."
)
cat(text)
```

```{r}
col_name <- "dollars_spent_purchases"
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> nrow() > 0

barplot_pmp(col_name)
```

### E-Zone

```{r}
#| fig-height: 7
#| eval: !expr df_conditions |> filter(name == col_name) |> count(ezone) |>filter(n > 5) |> nrow() > 1

barplot_pmp(col_name, facet_column = "ezone")
```

### Woman-Owned

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> count(woman_owned) |>filter(n > 5) |> nrow() > 1
#| fig-height: 7
barplot_pmp(col_name, facet_column = "woman_owned")
```


### BIPOC-Owned

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> count(bipoc_owned) |>filter(n > 5) |> nrow() > 1
#| fig-height: 7
barplot_pmp(col_name, facet_column = "bipoc_owned")
```

### Business Size

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> count(large_company) |>filter(n > 5) |> nrow() > 1
#| fig-height: 7
barplot_pmp(col_name, facet_col = "large_company")
```

:::

## What percentage of your business’s external spending went to BIPOC-owned businesses in the Portland Metro area?

```{r}
col_name <- "percentage_purchase"
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> nrow() > 5
barplot_pmp(col_name, is_percent = TRUE)
```

### E-Zone

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> count(ezone) |> nrow() > 1
#| fig-height: 7
barplot_pmp(col_name, facet_column = "ezone", is_percent = TRUE)
```

### Woman-Owned

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> count(woman_owned) |> nrow() > 1
#| fig-height: 7
barplot_pmp(col_name, facet_column = "woman_owned", is_percent = TRUE)
```

### BIPOC-Owned

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> count(bipoc_owned) |> nrow() > 1
#| fig-height: 7
barplot_pmp(col_name, facet_column = "bipoc_owned", is_percent = TRUE)
```

### Business Size

```{r}
#| eval: !expr df_conditions |> filter(name == col_name) |> count(large_company) |> nrow() > 1
#| fig-height: 7
barplot_pmp(col_name, facet_column = "large_company", is_percent = TRUE)
```

:::

---

# Culture Change 

## Did your business implement any of the following policies, practices, or actions? 

```{r}
col_names <- c(
  "practices_accountability_culture",
  "practices_affinity_culture",
  "practices_analysisexp_culture",
  "practices_analysispay_culture",
  "practices_budget_culture",
  "practices_designated_culture",
  "practices_feedback_culture",
  "practices_growth_culture",
  "practices_none_culture",
  "practices_supportive_culture",
  "practices_tracking_culture",
  "practices_training_culture"
)

df_with_condition <- df |>
  filter(action_culture=="Yes" | progress_culture=="Yes")
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
summary_table(col_names, data = df_with_condition)
```

### E-Zone

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "ezone")
```

### Woman-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "woman_owned")
```

### BIPOC-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "bipoc_owned")
```

### Business Size

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "large_company")
```

:::


---

# E-Zone Businesses

The following questions concern E-Zone businesses only.

```{r}
df_ezone <- df |> filter(ezone == "E-Zone Business")
```

## How much did your business spend on purchases within the City of Portland?

```{r, results='asis'}
col_name <- "spend_locally_portland_ezone"
total_spend <- df_ezone |>
  pull(col_name) |>
  sum(na.rm = TRUE)
text <- glue(
  "The total amount of dollars spent on purchases within the City of Portland is **{scales::dollar_format()(total_spend)}**."
)
cat(text)
```


```{r}
barplot_pmp("spend_locally_portland_ezone", data = df_ezone)
```

## What additional steps did your business take in 2024 to fulfill your Enterprise Zone commitments?

```{r}
col_names <- c(
  "steps_fund_ezone",
  "steps_groups_ezone",
  "steps_highed_ezone",
  "steps_hire_ezone",
  "steps_industry_ezone",
  "steps_initiative_ezone",
  "steps_jobs_ezone",
  "steps_none_ezone",
  "steps_nonprof_ezone",
  "steps_other_ezone",
  "steps_pay_ezone",
  "steps_school_ezone",
  "steps_smallbus_ezone"
)
summary_table(col_names, data = df_ezone)
```



---


# Overall Portland Means Progress Experience

## Did your business connect with other Portland Means Progress businesses about your commitments?

```{r}
col_names <- c("connect")
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
summary_table(col_names, data = df)
```

### E-Zone

```{r}
summary_table(col_names, data = df, group_cols = "ezone")
```

### Woman-Owned

```{r}
summary_table(col_names, data = df, group_cols = "woman_owned")
```

### BIPOC-Owned

```{r}
summary_table(col_names, data = df, group_cols = "bipoc_owned")
```

### Business Size

```{r}
summary_table(col_names, data = df, group_cols = "large_company")
```

### Individual Responses

```{r}
df_with_condition <- df |>
  select(business, connect) |>
  rename(`Business Name` = business, Response = connect)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(
  df_with_condition,
  "download-qualitative/connect.xlsx"
)
```

:::

## Tell us about a time when your business took meaningful action

```{r}
df_with_condition <- df |>
  select(business, meaningful_action) |>
  filter(str_length(meaningful_action) > 3) |>
  rename(`Business Name` = business, Response = meaningful_action)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(
  df_with_condition,
  "download-qualitative/meaningful_action.xlsx"
)
```

## Rate how strongly you agree or disagree with the following statement: Portland Means Progress supported my organization to meaningfully advance our racial equity goals 

::: {.panel-tabset .nav-pills}

### Summary


```{r}
order_levels <- c(
  "Strongly agree",
  "Agree",
  "Neutral",
  "Disagree",
  "Strongly disagree",
  "Other"
)

df |>
  count(pmplikert) |>
  mutate(percentage = n / sum(n) * 100) |>
  mutate(
    percentage = paste0(round(percentage, 1), "% (", n, " businesses)")
  ) |>
  select(-n) |>
  mutate(pmplikert = factor(pmplikert, levels = order_levels)) |>
  arrange(pmplikert) |>
  rename(
    Percentage = percentage,
    `Agreement Level` = pmplikert
  ) |>
  gt() |>
  cols_align("left", columns = vars(`Agreement Level`)) |>
  pmp_table_theme()
```

### Individual Responses

```{r}
df_with_condition <- df |>
  select(business, pmplikert) |>
  rename(
    `Business Name` = business,
    `Agree Level` = pmplikert
  )

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(
  df_with_condition,
  "download-qualitative/pmplikert.xlsx"
)
```

:::


## How did being a member of Portland Means Progress support you to meaningfully advance your racial equity goals? 

```{r}
df_with_condition <- df |>
  select(business, pmpgoals) |>
  filter(str_length(pmpgoals) > 3) |>
  rename(`Business Name` = business, Response = pmpgoals)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(df_with_condition, "download-qualitative/pmpgoals_2024.xlsx")
```

## What challenges did your business face in 2024 when working towards your commitment to work experience, intentional purchasing, culture change, or other racial equity issues?

```{r}
df_with_condition <- df |>
  select(business, challenges) |>
  filter(str_length(challenges) > 3) |>
  rename(`Business Name` = business, Response = challenges)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(df_with_condition, "download-qualitative/challenges_2024.xlsx")
```

## What additional support does your business need to make progress in your work experience, intentional purchasing, or culture change efforts?

```{r}
df_with_condition <- df |>
  select(business, pmpsupport) |>
  rename(`Business Name` = business, Support = pmpsupport)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(df_with_condition, "download-qualitative/pmpsupport.xlsx")
```


## Approximately how many people are employed by your business in the Portland Metro area? 

```{r}
df_with_condition <- df |>
  select(business, n_employees) |>
  rename(`Business Name` = business, Employees = n_employees)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(df_with_condition, "download-qualitative/n_employees.xlsx")
```

---

# 2024 Portland Means Progress Commitments 

## Does your business recommit to Portland Means Progress in 2025? 


```{r}
df_with_condition <- df |>
  select(business, recommit) |>
  rename(`Business Name` = business, Recommit = recommit)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(df_with_condition, "download-qualitative/recommit_2025.xlsx")
```


## Which Portland Means Progress action(s) does your business commit to in 2025? 


```{r}
df_with_condition <- df |>
  select(
    business,
    recommit,
    action_culture,
    action_purchasing,
    action_work
  ) |>
  mutate(action_culture = replace_na(action_culture, "No")) |>
  mutate(action_purchasing = replace_na(action_purchasing, "No")) |>
  mutate(action_work = replace_na(action_work, "No")) |>
  rename(
    `Business Name` = business,
    Recommit = recommit,
    Culture = action_culture,
    Purchasing = action_purchasing,
    Work = action_work
  )

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(
  df_with_condition,
  "download-qualitative/recommit_2025_details.xlsx"
)
```



## Which of the following internship and workplace experience programs does your business plan on implementing or continuing in 2025?

The following question apply only to businesses that are planning to commit to work experience in 2025.

```{r}
df_with_condition <- df |> filter(action_work == "Yes")
col_names <- c(
  "work_intern_other",
  "work_intern_unsure",
  "work_leaders",
  "work_summer"
)
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
summary_table(col_names, data = df_with_condition)
```

### E-Zone

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "ezone")
```

### Woman-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "woman_owned")
```

### BIPOC-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "bipoc_owned")
```

### Business Size

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "large_company")
```

:::

## Which of the following policies, practices, or actions does your business plan on implementing or continuing in 2025?

The following question apply only to businesses that are planning to commit to work experience in 2025.

```{r}
df_with_condition <- df |> filter(action_work == "Yes")
col_names <- c(
  "continue_mercatus_purchasing",
  "continue_cobid_purchasing",
  "continue_targets_purchasing",
  "continue_tracking_purchasing",
  "continue_none_purchasing",
  "continue_relations_purchasing",
  "continue_preference_purchasing",
  "continue_dollar_purchasing"
)
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
summary_table(col_names, data = df_with_condition)
```

### E-Zone

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "ezone")
```

### Woman-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "woman_owned")
```

### BIPOC-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "bipoc_owned")
```

### Business Size

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "large_company")
```

:::

## Which of the following policies, practices, or actions does your business plan on implementing or continuing in 2025? 

The following question apply only to businesses that are planning to commit to intentional purchasing in 2025.


```{r}
df_with_condition <- df |> filter(action_purchasing == "Yes")
col_names <- c(
  "continue_mercatus_purchasing",
  "continue_cobid_purchasing",
  "continue_targets_purchasing",
  "continue_tracking_purchasing",
  "continue_none_purchasing",
  "continue_relations_purchasing",
  "continue_preference_purchasing",
  "continue_dollar_purchasing"
)
```

::: {.panel-tabset .nav-pills}

### All Businesses

```{r}
summary_table(col_names, data = df_with_condition)
```

### E-Zone

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "ezone")
```

### Woman-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "woman_owned")
```

### BIPOC-Owned

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "bipoc_owned")
```

### Business Size

```{r}
summary_table(col_names, data = df_with_condition, group_cols = "large_company")
```

:::

## What is your top priority in 2025 to advance your internal Culture Change goals?

The following question apply only to businesses that are planning to commit to culture change in 2025.

```{r}
df_with_condition <- df |>
  filter(action_culture == "Yes") |>
  select(business, continue_priority_culture) |>
  rename(`Business Name` = business, Response = continue_priority_culture)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(
  df_with_condition,
  "download-qualitative/continue_priority_culture.xlsx"
)
```


## Why are you not committing to Portland Means Progress in 2025? How can we improve?

The following question apply only to businesses **not** planning to recommit to the PMP in 2025.

```{r}
df_with_condition <- df |>
  filter(recommit == "No") |>
  select(business, no_commit) |>
  rename(`Business Name` = business, Response = no_commit)

df_with_condition |>
  gt() |>
  format_qualitative() |>
  pmp_table_theme()

download_button(df_with_condition, "download-qualitative/commit_2025.xlsx")
```

---

# Additional findings

## Women and BIPOC owned businesses

```{r, results='asis'}
n_bipoc_owned <- df |> filter(bipoc_owned == "BIPOC Owned") |> nrow()
n_woman_owned <- df |> filter(woman_owned == "Woman Owned") |> nrow()
n_bipoc_and_woman_owned <- df |> filter(woman_owned == "Woman Owned" & bipoc_owned == "BIPOC Owned") |> nrow()

text <- glue("Number of BIPOC owned businesses: **{n_bipoc_owned}** ({round(n_bipoc_owned/nrow(df)*100,1)}%).")
cat(text, "\n\n")
text <- glue("Number of women owned businesses: **{n_woman_owned}** ({round(n_woman_owned/nrow(df)*100,1)}%).")
cat(text, "\n\n")
text <- glue("Number of BIPOC *and* women owned businesses: **{n_bipoc_and_woman_owned}** ({round(n_bipoc_and_woman_owned/nrow(df)*100,1)}%).")
cat(text, "\n\n")
```

## Spending large businesses BIPOC

```{r, results='asis'}
df_bipoc <- df |>
  filter(bipoc_owned == "BIPOC Owned")

total_spend_large_bus <- df_bipoc |>
  filter(large_company == "Large (n > 50)") |>
  summarise(total = sum(dollars_spent_purchases, na.rm = TRUE)) |>
  pull(total)

total_spend <- df_bipoc |>
  summarise(total = sum(dollars_spent_purchases, na.rm = TRUE)) |>
  pull(total)

share <- round(total_spend_large_bus / total_spend * 100, 1)
text <- glue("In 2024, large businesses account for **{share}%** of reported spending at BIPOC-owned businesses.")
cat(text, "\n\n")
```

## Commitments among the top 10 spenders

```{r, results='asis'}
n_commited_big_spenders <- df |>
  select(business, dollars_spent_purchases, connect) |>
  arrange(desc(dollars_spent_purchases)) |>
  head(10) |>
  filter(connect == "Yes") |>
  nrow()

text <- glue("Of the top ten Portland Means Progress businesses with the highest intentional spend, **{n_commited_big_spenders} of the 10** reported connecting with other Portland Means Progress businesses about their commitments.")
cat(text, "\n\n")
```

## Business commitments

::: {.panel-tabset .nav-pills}

### Action

```{r}
col_names <- c("action_culture", "action_work", "action_purchasing")
summary_table(col_names, data = df)
```

### Progress

```{r}
col_names <- c("progress_culture", "progress_work", "progress_purchasing")
summary_table(col_names, data = df)
```

:::

<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>